%%% Macros useful almost everywhere

%%% Thanking projects

\newcommand{\tnxbehapi}[1][partly]{
  %
  Research {#1} supported by the EU H2020 RISE programme under the
  Marie Sk{\l}odowska-Curie grant agreement No 778233
}

\newcommand{\tnxitmatters}[1][Work partially funded]{
  %
   #1 by MIUR project PRIN 2017FTXR7S \emph{IT MATTERS}
  (Methods and Tools for Trustworthy Smart Systems)
}
%%% Thanking projects end

\usepackage{xargs}
\usepackage[normalem]{ulem} % underline command breaks over line ends
% \usepackage[UKenglish]{babel}
% \usepackage{bm}  some strange fonts needed somewhere

\usepackage{xifthen}        % for conditional commands
\newcommand{\ifempty}[3]{%
  \ifthenelse{\isempty{#1}}{#2}{#3}%
}

\DeclareGraphicsExtensions{%
  .png,.PNG,%
  .pdf,.PDF,%
  .jpg,.mps,.jpeg,.jbig2,.jb2,.JPG,.JPEG,.JBIG2,.JB2
}



%%% My flags
\newif\ifemi
%%% My flags end

%% Meta-comments
\usepackage{fixme}
\fxusetheme{color}
\FXRegisterAuthor{eM}{aeM}{\color{orange} {\underline{eM}}}
%\usepackage[disable]{todonotes}
\newcommand{\eMtodo}[1]{\todo[fancyline,color=orange!10]{\tiny eM: \color{NavyBlue}#1}}
\usepackage[most]{tcolorbox}
\newtcolorbox{markbox}{
  enhanced,
  breakable,
  size=minimal,
  parbox=false,
  after upper={},
  before upper={},
  % after={\par},
  % before upper={\indent},
  colback=white,
  overlay = {
	 \draw[line width=2pt]
	 (frame.north east) -| ([xshift=3mm]frame.east) |-(frame.south east);
  },
  overlay first={\draw[line width=2pt] (frame.north east) -| ([xshift=3mm]frame.south east);},
  overlay middle={\draw[line width=2pt] ([xshift=3mm]frame.north east) -- ([xshift=3mm]frame.south east);},
  overlay last={\draw[line width=2pt] ([xshift=3mm]frame.north east) |- (frame.south east);},
}

\newcommand{\eMcomm}[2][check]{
  \todo[fancyline,color=orange!10]{\tiny eM: \color{NavyBlue}#1}
%  \begin{markbox}
	 {\color{SaddleBrown}{#2}}
%  \end{markbox}
}

\definecolor{ao(english)}{rgb}{0.0, 0.5, 0.0}
\newcommand{\iLcomm}[2]{
  \todo[fancyline,color=orange!10]{\tiny iL: \color{NavyBlue}#2}
%  \begin{markbox}
	 {\color{ao(english)}{#1}}
%  \end{markbox}
}
\newcommand{\fBcomm}[2]{
  \todo[fancyline,color=cyan!10]{\tiny fB: \color{NavyBlue}#2}
%  \begin{markbox}
	 {\color{red}{#1}}
%  \end{markbox}
}

\newcommand{\nota}[2][TODO]{::\textcolor{red}{#1}:: \color{cyan} #2}
\newcommand{\okey}{\dSmiley}
\newcommand{\yeko}{\dXey}
\newcommand{\hidden}[1]{}
\newcommand{\hide}[1]{}

\newcommand{\cf}[2]{
  \fontsize{#1}{#1}{\selectfont{#2}}
}

\ifemi
\usepackage{showlabels}
\renewcommand{\showlabelsetlabel}[1]{
  {\textcolor{ForestGreen}{
		\showlabelfont{\tiny #1}}
  }
}
\newcommand{\emi}[2]{
  \marginpar{\fcolorbox{red}{shadecolor}{\cf{#1}{{#2}}}}
}
\newcommand{\emic}[2]{\par
  \fcolorbox{red}{shadecolor}{\parbox{\linewidth}{ 
      \color{gray}
      \begin{description}
      \item[{\color{blue} #2}]{\sf #1}
      \end{description}}}
}
\else
\newcommand{\emi}[2]{}
\newcommand{\emic}[2]{}{}
\fi

\newcommand{\marginnote}[1]{
  {\makebox[0pt]{\color{orange}}}
  \marginpar{\parbox{2cm}{\flushleft \tiny \color{orange}{#1}}}
}
\newcommand{\side}[2][6]{
  \marginpar{\cf{#1}{\hl{#2}}}
}
\newcommand{\HSLtag}{\scalebox{1.25}{%
  \begin{tikzpicture}
  \draw (0.1,0.2) -- (0.2,0.115) -- (0.3,0.2) ;
  %
  \draw (0.1,0.2) -- (0.15,0.1) ;
  \draw (0.3,0.2) -- (0.25,0.1) ;
  %
  \draw (0.12,0.1) -- (0.2,0.05) -- (0.28,0.1) ;
  %
  \draw (0.2,0) circle (0.12) ; 
  \draw (0.16,0.04) circle (0.01) ;
  \draw (0.24,0.04) circle (0.01) ;
  \draw (0.15,-0.07) -- (0.25,-0.07) ;
  \end{tikzpicture}
}}
\newcommand{\HSLbox}{\rule{1ex}{1ex}}
\newcommand{\hsl}[1][]{\par
  {\color{red}\vbox{\medskip\noindent\hrulefill \\[5pt]
  \HSLtag \hspace{\stretch{1}}HIC SUNT
  LEONES \; {#1}\hspace{\stretch{1}} \HSLtag \\ \smallskip\noindent\hrulefill \\}}\par
}
%%% Meta-comments end



%%% Maths & logic
\newcommand{\Set}[1]{\{\,#1\,\}}
\newcommand{\SET}[1]{\big\{\,#1\,\big\}}
\def\colorFun{\color{orange}}
\newcommand{\mkfun}[4][\colorFun]{
  \newcommand{#2}[1][#4]{
    {#1\textsf{#3}}
    \ifempty{##1}{}{
      ({##1})}
  }
}

\mkfun{\head}{hd}{}
\mkfun{\tail}{tl}{}

\newcommand{\mkuop}[4][\colorFun]{
  \newcommand{#2}[1][#4]{
    {#1\textsf{#3}}
    \ifempty{##1}{}{
      \, {##1}}
  }
}
\newcommand{\mkset}[1]{\big\{ {#1} \big\}} %%% formerly called \ASET
\newcommand{\partsof}[1]{2^{#1}} %%% formerly called \ASET
\newcommand{\setof}[1]{\mkset{#1}}
\newcommand{\setdef}[2]{\mkset{#1 \sst #2}}
\newcommand{\card}[1]{\|{#1}\|}
\newcommand{\sst}{\;\big|\;}
\newcommand{\qst}{\;\colon\;} %such that
\newcommand{\dom}[1]{\operatorname{dom} {#1}}
\newcommand{\cod}[1]{\operatorname{cod} {#1}}
\newcommand\myenddef{~\hfill \ensuremath{\diamond}}
\newcommand{\conf}[1]{\ensuremath{\langle {#1} \rangle}}
\newcommand{\tuple}[1]{\conf{#1}}
\newcommand{\acsconf}[2]{\conf{{#1} \ ; \ {#2}}}
%\renewcommand{\vec}[1]{\overset{\to}{#1}}
\newcommand{\ith}[2]{\vec{#1}[{#2}]}
\newcommand{\emptyword}{\varepsilon}
\newcommand{\acword}{w}
\newcommand{\aaword}{v}
\newcommand{\aword}{z}
\newcommand{\langof}[1]{\mathcal{L}(#1)}
\newcommand{\sem}[2][]{\mbox{\ensuremath{\llbracket{#2}\rrbracket_{#1}}}}
\newcommand{\qmmdef}{\quad \mmdef \quad}
\newcommand{\qqmmdef}{\qquad \mmdef \qquad}
\newcommand{\qqand}[1][and]{\qquad\text{#1}\qquad}
\newcommand{\qand}[1][and]{\quad\text{#1}\quad}
\newcommand{\verum}{\mathtt{tt}}
\newcommand{\falsus}{\mathtt{ff}}
\newcommand{\nat}{\mathbb{N}}
\newcommand{\upd}[3]{{#1}[{#2} \mapsto {#3}]}
\newcommand{\grmeq}{\; ::= \;}
\newcommand{\bnfdef}{\ ::=\ }
\newcommand{\grmor}{\; \big| \;}
\newcommand{\bnfmid}{\;\ \big|\ \;}
\newcommand{\sep}{\;\bnfmid\;}
\mkfun{\pref}{pref}{}
%%% Maths & logic end

\newcommand{\glanguages}{\mathbb{G}}
\newcommand{\csystems}{\mathbb{S}}
\mkfun{\cl}{cl}{}


%%% Typographic style
\newcommand{\defrule}[1]{%
  % \hypertarget{rule:{#1}}
  {%
    \text{\scriptsize[\textbf{#1}]}%
  }%
}
\newcommand{\ie}{\text{i.e.}\xspace}
\newcommand{\cfw}{\text{cf.}\xspace}
\newcommand{\eg}{\text{e.g.}\xspace}
\newcommand{\aka}{\text{a.k.a.}\xspace}
\newcommand{\mypar}[1]{\noindent\paragraph{\textbf{#1}}\ }
\newcommand{\secref}[1]{\S~\ref{#1}}
\newcommand{\figref}[1]{Fig.~\ref{#1}}
\newcommand{\exref}[1]{Ex.~\ref{#1}}
\newcommand{\defref}[1]{Definition~\ref{#1}}
\newcommand{\exeref}[1]{Exercise~\ref{#1}}
% \newtheorem{fact}[definition]{Fact}
\newtheorem{rmk}{Remark}{\bfseries}{\rmfamily}
\newtheorem{exe}{Exercise}{\bfseries}{\rmfamily}
\newcommand{\sidebyside}[2]{
  \begin{tabular}{ll}
    \begin{minipage}{.5\linewidth} {#1}  \end{minipage}
    &
    \begin{minipage}{.5\linewidth} {#2}  \end{minipage}
  \end{tabular}
}
\newcommand{\eqdef}{\ \triangleq\ }
\newcommand{\mmdef}{\eqdef}
%%% Typographic style end



%%% Arrows
\def\ured{\rightarrow}
\def\tred#1{\overstackrel{\rightarrowfill}{#1}}
\def\iured#1{\rightarrow_{\descr{\scriptstyle #1}}}
\def\itred#1#2{\mathrel{{\overstackrel{\rightarrowfill}{#2}}_{\descr
      {\scriptstyle #1}}}}
\def\sytr#1{\overstackrel{\longmapsto}{#1}}
\def\tr#1{\overstackrel{\rightarrowfill}{#1}}
\def\actr#1#2{\overstackrel{\rightarrowfill}{\act {#1}{#2}}}
\def\iactr#1#2#3{\overstackrel{\rightarrowfill}{\act {#2}{#3}}_{\descr
    {\scriptstyle #1}}}
\def\dlarrow#1#2{\overunderstackrel{\rightarrowfill}{#1}{#2}}
\def\ddlarrow#1#2{\overunderstackrel{\longmapsto}{#1}{#2}}
\def\Dlarrow#1#2{\overunderstackrel{\Longrightarrow}{#1}{#2}}
\def\dmtarrow#1#2{\overunderstackrel{\longmapsto}{#1}{#2}}
\def\mtarrow#1{\overstackrel{\longmapsto}{#1}}
\newcommand{\mylarrow}[1]{\overstackrel{\rightarrowfill}{#1}}

\newcommand{\partarrow}[2]{\overunderstackrel{\rightarrowfill}{\ \ \mbox{\scriptstyle $#1$}\ \ }{\ \mbox{\scriptstyle $#2$}\ }\!\!\!>}
\newcommand{\arw}[1]{\overstackrel{\rightarrowfill}{#1}}
\newcommand{\newpartarrow}[2]{\partarrow{#1}{}}
\newcommand{\spartarrow}[1]{\overstackrel{\rightarrowfill}{\ \ \mbox{\scriptstyle $#1$}\ \ \ }\!\!\!\!\!>}
\newcommand{\trlts}[1]{\overstackrel{\rule[.8mm]{7mm}{.2mm}}{#1}\!\!\blacktriangleright}
\newcommand{\trred}{\overstackrel{\rule[.8mm]{7mm}{.2mm}}\!\!\vartriangleright}
%%% Arrows end

%%% Others
\newcommand{\squo}[1]{\lq {#1}\rq}
\newcommand{\quo}[1]{\lq\lq {#1}\rq\rq}
\def\finex{{\unskip\nobreak\hfil
\penalty50\hskip1em\null\nobreak\hfil$\diamond$
\parfillskip=0pt\finalhyphendemerits=0\endgraf}}
\newenvironment{myex}{\begin{example}\it}{\finex\end{example}}
%%% Others end
\newcommand{\rmkend}{\finex}


%%% Some colors
\definecolor{shadecolor}{rgb}{1,0.99,0.9}
\definecolor{bg}{rgb}{0.95,0.95,0.95}
\newcommand{\newgreen}{green!50!blue!100}
%%% Some colors end


\ExplSyntaxOn
\NewDocumentCommand{\ucgreek}{m}
 {
  \str_case:nn { #1 }
   {
    {A}{\mathrm{A}}
    {B}{\mathrm{B}}
    {C}{\Sigma}
    {D}{\Delta}
    {E}{\mathrm{E}}
    {F}{\Phi}
    {G}{\Gamma}
    {H}{\mathrm{H}}
    {I}{\mathrm{I}}
    {J}{\Theta}
    {K}{\mathrm{K}}
    {L}{\Lambda}
    {M}{\mathrm{M}}
    {N}{\mathrm{N}}
    {O}{\mathrm{O}}
    {P}{\Pi}
    {Q}{\mathrm{X}}
    {R}{\mathrm{P}}
    {S}{\Sigma}
    {T}{\mathrm{T}}
    {U}{\Upsilon}
    %{V}{}
    {W}{\Omega}
    {X}{\Xi}
    {Y}{\Psi}
    {Z}{\mathrm{Z}}
   }
 }
\NewDocumentCommand{\lcgreek}{m}
 {
  \str_case:nn { #1 }
   {
    {a}{\alpha}
    {b}{\beta}
    {c}{\varsigma}
    {d}{\delta}
    {e}{\varepsilon}
    {f}{\varphi}
    {g}{\gamma}
    {h}{\eta}
    {i}{\iota}
    {j}{\vartheta}
    {k}{\kappa}
    {l}{\lambda}
    {m}{\mu}
    {n}{\nu}
    {o}{o}
    {p}{\pi}
    {q}{\chi}
    {r}{\rho}
    {s}{\sigma}
    {t}{\tau}
    {u}{\upsilon}
    %{v}{}
    {w}{\omega}
    {x}{\xi}
    {y}{\psi}
    {z}{\zeta}
   }
 }
\ExplSyntaxOff

\newcommand{\alphabetname}[1]{\uppercase{\ucgreek{#1}}}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
